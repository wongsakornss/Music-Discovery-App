{% extends 'base.html' %}
{% block content %}

<h2 class="text-xl font-semibold">üéµ {{ pl.name }} <span class="text-white/60 text-sm">(‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞)</span></h2>
{% if pl.description %}
  <p class="text-white/60 mt-1">{{ pl.description }}</p>
{% endif %}

<!-- ‡πÅ‡∏ñ‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ + ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå -->
<div class="mt-3 flex flex-wrap items-center gap-2">
  <span class="text-white/60 text-sm">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏û‡∏•‡∏á: {{ tracks|length }}</span>
  <button id="copyLinkBtn"
          class="rounded-xl border border-white/10 px-3 py-1.5 text-sm hover:bg-white/10"
          data-url="{{ share_url }}">
    ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå
  </button>
  {% if share_url %}
    <a href="{{ share_url }}" target="_blank" rel="noopener"
       class="rounded-xl border border-white/10 px-3 py-1.5 text-sm hover:bg-white/10">
      ‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ
    </a>
  {% endif %}
</div>

<!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏•‡∏á -->
{% if tracks and tracks|length > 0 %}
  <ul class="mt-5 grid gap-3">
    {% for t in tracks %}
      <li class="rounded-2xl border border-white/10 bg-white/5 p-4 flex items-center justify-between">
        <div class="min-w-0 pr-4">
          <div class="font-medium truncate">{{ t.title }}</div>
          <div class="text-white/60 text-sm truncate">{{ t.artist }}</div>
          {% if t.url %}
            <a href="{{ t.url }}" target="_blank" rel="noopener"
               class="text-emerald-300 text-sm hover:underline">‡∏î‡∏π‡∏ö‡∏ô Last.fm</a>
          {% endif %}
        </div>
        <div class="text-white/40 text-xs shrink-0">#{{ t.position }}</div>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p class="text-white/60 mt-5">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏û‡∏•‡∏á‡πÉ‡∏ô‡πÄ‡∏û‡∏•‡∏¢‡πå‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏ô‡∏µ‡πâ</p>
{% endif %}

<!-- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå -->
<script>
  (function () {
    const btn = document.getElementById('copyLinkBtn');
    if (!btn) return;
    btn.addEventListener('click', async () => {
      const url = btn.getAttribute('data-url') || window.location.href;
      try {
        await navigator.clipboard.writeText(url);
        btn.textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úì';
        setTimeout(() => btn.textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå', 1600);
      } catch (e) {
        // fallback
        const tmp = document.createElement('input');
        tmp.value = url;
        document.body.appendChild(tmp);
        tmp.select();
        document.execCommand('copy');
        document.body.removeChild(tmp);
        btn.textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úì';
        setTimeout(() => btn.textContent = '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå', 1600);
      }
    });
  })();
</script>

{% endblock %}
